<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
    <script src="stats_grab.js"></script>
</head>
<body>

 <h1>CEDA Archive Overview</h1>

 <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.44.0 (20200408.0750)
 -->
<!-- Title: G Pages: 1 -->
<svg width="738pt" height="925pt"
 viewBox="0.00 0.00 738.00 925.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 921)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-921 734,-921 734,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_arrivals</title>
<polygon fill="#ccccff" stroke="#ccccff" points="8,-649 8,-838 224,-838 224,-649 8,-649"/>
<text text-anchor="middle" x="116" y="-822.8" font-family="Times,serif" font-size="14.00">Arrivals</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_es</title>
<polygon fill="#ccffcc" stroke="#ccffcc" points="430,-439 430,-514 722,-514 722,-439 430,-439"/>
<text text-anchor="middle" x="576" y="-498.8" font-family="Times,serif" font-size="14.00">elastic search</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_ingest</title>
<polygon fill="lightgrey" stroke="lightgrey" points="298,-743 298,-840 648,-840 648,-743 298,-743"/>
<text text-anchor="middle" x="473" y="-824.8" font-family="Times,serif" font-size="14.00">Ingest</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_rabbitmq</title>
<polygon fill="#ffccff" stroke="#ffccff" points="377,-544 377,-724 643,-724 643,-544 377,-544"/>
<text text-anchor="middle" x="510" y="-708.8" font-family="Times,serif" font-size="14.00">RabbitMQ</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_deposit</title>
<polygon fill="pink" stroke="pink" points="185,-439 185,-630 369,-630 369,-439 185,-439"/>
<text text-anchor="middle" x="277" y="-614.8" font-family="Times,serif" font-size="14.00">Deposit server</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_access</title>
<polygon fill="#ffffcc" stroke="#ffffcc" points="182,-65 182,-420 460,-420 460,-65 182,-65"/>
<text text-anchor="middle" x="321" y="-404.8" font-family="Times,serif" font-size="14.00">access</text>
</g>
<!-- data_provider -->
<g id="node1" class="node">
<title>data_provider</title>
<polygon fill="yellow" stroke="black" points="266.91,-881.05 270.82,-881.15 274.69,-881.3 278.51,-881.49 282.25,-881.74 285.91,-882.03 289.47,-882.36 292.91,-882.75 296.22,-883.18 299.39,-883.65 302.41,-884.16 305.27,-884.71 307.96,-885.31 310.46,-885.94 312.78,-886.61 314.91,-887.31 316.83,-888.04 318.55,-888.8 320.07,-889.59 321.37,-890.41 322.47,-891.25 323.36,-892.11 324.04,-892.99 324.51,-893.89 324.78,-894.8 324.86,-895.72 324.73,-896.65 324.43,-897.59 323.94,-898.53 323.27,-899.47 322.43,-900.41 321.44,-901.35 320.29,-902.28 319,-903.2 317.58,-904.11 316.03,-905.01 314.36,-905.89 312.58,-906.75 310.7,-907.59 308.72,-908.41 306.67,-909.2 304.54,-909.96 302.33,-910.69 300.07,-911.39 297.75,-912.06 295.38,-912.69 292.98,-913.29 290.53,-913.84 288.05,-914.35 285.54,-914.82 283.01,-915.25 280.46,-915.64 277.9,-915.97 275.32,-916.26 272.73,-916.51 270.13,-916.7 267.53,-916.85 264.92,-916.95 262.31,-917 259.69,-917 257.08,-916.95 254.47,-916.85 251.87,-916.7 249.27,-916.51 246.68,-916.26 244.1,-915.97 241.54,-915.64 238.99,-915.25 236.46,-914.82 233.95,-914.35 231.47,-913.84 229.02,-913.29 226.62,-912.69 224.25,-912.06 221.93,-911.39 219.67,-910.69 217.46,-909.96 215.33,-909.2 213.28,-908.41 211.3,-907.59 209.42,-906.75 207.64,-905.89 205.97,-905.01 204.42,-904.11 203,-903.2 201.71,-902.28 200.56,-901.35 199.57,-900.41 198.73,-899.47 198.06,-898.53 197.57,-897.59 197.27,-896.65 197.14,-895.72 197.22,-894.8 197.49,-893.89 197.96,-892.99 198.64,-892.11 199.53,-891.25 200.63,-890.41 201.93,-889.59 203.45,-888.8 205.17,-888.04 207.09,-887.31 209.22,-886.61 211.54,-885.94 214.04,-885.31 216.73,-884.71 219.59,-884.16 222.61,-883.65 225.78,-883.18 229.09,-882.75 232.53,-882.36 236.09,-882.03 239.75,-881.74 243.49,-881.49 247.31,-881.3 251.18,-881.15 255.09,-881.05 259.03,-881 262.97,-881 266.91,-881.05"/>
<text text-anchor="middle" x="261" y="-895.3" font-family="Times,serif" font-size="14.00">data_provider</text>
</g>
<!-- gws -->
<g id="node2" class="node">
<title>gws</title>
<path fill="gray" stroke="black" d="M288,-794.73C288,-796.53 275.9,-798 261,-798 246.1,-798 234,-796.53 234,-794.73 234,-794.73 234,-765.27 234,-765.27 234,-763.47 246.1,-762 261,-762 275.9,-762 288,-763.47 288,-765.27 288,-765.27 288,-794.73 288,-794.73"/>
<path fill="none" stroke="black" d="M288,-794.73C288,-792.92 275.9,-791.45 261,-791.45 246.1,-791.45 234,-792.92 234,-794.73"/>
<text text-anchor="middle" x="261" y="-776.3" font-family="Times,serif" font-size="14.00">gws</text>
</g>
<!-- data_provider&#45;&gt;gws -->
<g id="edge17" class="edge">
<title>data_provider&#45;&gt;gws</title>
<path fill="none" stroke="black" stroke-width="4" d="M261,-880.99C261,-861.92 261,-830.75 261,-808.28"/>
<polygon fill="black" stroke="black" stroke-width="4" points="264.5,-808.03 261,-798.03 257.5,-808.03 264.5,-808.03"/>
</g>
<!-- arrivals -->
<g id="node4" class="node">
<title>arrivals</title>
<g id="a_node4"><a xlink:href="https://arrivals.ceda.ac.uk" xlink:title="arrivals">
<polygon fill="white" stroke="black" points="130,-807 16,-807 16,-753 130,-753 130,-807"/>
<image xlink:href="images/arrivals_s.png" width="114px" height="54px" preserveAspectRatio="xMinYMin meet" x="16" y="-807"/>
<text text-anchor="middle" x="73" y="-776.9" font-family="Times,serif" font-size="12.00">arrivals</text>
</a>
</g>
</g>
<!-- data_provider&#45;&gt;arrivals -->
<g id="edge15" class="edge">
<title>data_provider&#45;&gt;arrivals</title>
<path fill="none" stroke="black" stroke-width="4" d="M223.5,-883.47C198.58,-873.03 165.66,-857.72 139,-840 127.68,-832.47 116.3,-823.11 106.26,-814.07"/>
<polygon fill="black" stroke="black" stroke-width="4" points="108.59,-811.45 98.86,-807.25 103.85,-816.6 108.59,-811.45"/>
</g>
<!-- processing_disk -->
<g id="node12" class="node">
<title>processing_disk</title>
<g id="a_node12"><a xlink:href="http://stats.ceda.ac.uk/ingest_state/stream.html?streamname=simple_checks" xlink:title="processing_disk">
<path fill="gray" stroke="black" d="M410,-794.73C410,-796.53 386.69,-798 358,-798 329.31,-798 306,-796.53 306,-794.73 306,-794.73 306,-765.27 306,-765.27 306,-763.47 329.31,-762 358,-762 386.69,-762 410,-763.47 410,-765.27 410,-765.27 410,-794.73 410,-794.73"/>
<path fill="none" stroke="black" d="M410,-794.73C410,-792.92 386.69,-791.45 358,-791.45 329.31,-791.45 306,-792.92 306,-794.73"/>
<text text-anchor="middle" x="358" y="-776.3" font-family="Times,serif" font-size="14.00">processing_disk</text>
</a>
</g>
</g>
<!-- data_provider&#45;&gt;processing_disk -->
<g id="edge16" class="edge">
<title>data_provider&#45;&gt;processing_disk</title>
<path fill="none" stroke="black" stroke-width="4" d="M274.9,-881.24C291.23,-861.54 318.48,-828.67 337.3,-805.97"/>
<polygon fill="black" stroke="black" stroke-width="4" points="340.12,-808.04 343.81,-798.11 334.74,-803.58 340.12,-808.04"/>
<text text-anchor="middle" x="311" y="-851.8" font-family="Times,serif" font-size="14.00">pull</text>
</g>
<!-- deposit -->
<g id="node18" class="node">
<title>deposit</title>
<ellipse fill="blue" stroke="black" cx="229" cy="-570" rx="36.29" ry="18"/>
<text text-anchor="middle" x="229" y="-566.3" font-family="Times,serif" font-size="14.00">deposit</text>
</g>
<!-- gws&#45;&gt;deposit -->
<g id="edge12" class="edge">
<title>gws&#45;&gt;deposit</title>
<path fill="none" stroke="black" stroke-width="4" d="M258.38,-761.98C252.84,-725.93 239.87,-641.64 233.17,-598.1"/>
<polygon fill="black" stroke="black" stroke-width="4" points="236.59,-597.32 231.61,-587.96 229.67,-598.38 236.59,-597.32"/>
</g>
<!-- ds -->
<g id="node3" class="node">
<title>ds</title>
<polygon fill="yellow" stroke="black" points="491.68,-881.05 493.46,-881.15 495.22,-881.3 496.95,-881.49 498.65,-881.74 500.31,-882.03 501.92,-882.36 503.48,-882.75 504.99,-883.18 506.43,-883.65 507.8,-884.16 509.1,-884.71 510.32,-885.31 511.45,-885.94 512.51,-886.61 513.47,-887.31 514.35,-888.04 515.13,-888.8 515.81,-889.59 516.41,-890.41 516.91,-891.25 517.31,-892.11 517.62,-892.99 517.83,-893.89 517.96,-894.8 517.99,-895.72 517.93,-896.65 517.79,-897.59 517.57,-898.53 517.27,-899.47 516.89,-900.41 516.44,-901.35 515.92,-902.28 515.33,-903.2 514.69,-904.11 513.98,-905.01 513.22,-905.89 512.41,-906.75 511.56,-907.59 510.67,-908.41 509.73,-909.2 508.76,-909.96 507.76,-910.69 506.74,-911.39 505.68,-912.06 504.61,-912.69 503.52,-913.29 502.41,-913.84 501.28,-914.35 500.14,-914.82 498.99,-915.25 497.84,-915.64 496.67,-915.97 495.5,-916.26 494.33,-916.51 493.15,-916.7 491.96,-916.85 490.78,-916.95 489.59,-917 488.41,-917 487.22,-916.95 486.04,-916.85 484.85,-916.7 483.67,-916.51 482.5,-916.26 481.33,-915.97 480.16,-915.64 479.01,-915.25 477.86,-914.82 476.72,-914.35 475.59,-913.84 474.48,-913.29 473.39,-912.69 472.32,-912.06 471.26,-911.39 470.24,-910.69 469.24,-909.96 468.27,-909.2 467.33,-908.41 466.44,-907.59 465.59,-906.75 464.78,-905.89 464.02,-905.01 463.31,-904.11 462.67,-903.2 462.08,-902.28 461.56,-901.35 461.11,-900.41 460.73,-899.47 460.43,-898.53 460.21,-897.59 460.07,-896.65 460.01,-895.72 460.04,-894.8 460.17,-893.89 460.38,-892.99 460.69,-892.11 461.09,-891.25 461.59,-890.41 462.19,-889.59 462.87,-888.8 463.65,-888.04 464.53,-887.31 465.49,-886.61 466.55,-885.94 467.68,-885.31 468.9,-884.71 470.2,-884.16 471.57,-883.65 473.01,-883.18 474.52,-882.75 476.08,-882.36 477.69,-882.03 479.35,-881.74 481.05,-881.49 482.78,-881.3 484.54,-881.15 486.32,-881.05 488.1,-881 489.9,-881 491.68,-881.05"/>
<text text-anchor="middle" x="489" y="-895.3" font-family="Times,serif" font-size="14.00">ds</text>
</g>
<!-- ingest_control -->
<g id="node10" class="node">
<title>ingest_control</title>
<ellipse fill="blue" stroke="black" cx="489" cy="-780" rx="61.19" ry="18"/>
<text text-anchor="middle" x="489" y="-776.3" font-family="Times,serif" font-size="14.00">ingest_control</text>
</g>
<!-- ds&#45;&gt;ingest_control -->
<g id="edge14" class="edge">
<title>ds&#45;&gt;ingest_control</title>
<path fill="none" stroke="black" d="M489,-880.99C489,-861.92 489,-830.75 489,-808.28"/>
<polygon fill="black" stroke="black" points="492.5,-808.03 489,-798.03 485.5,-808.03 492.5,-808.03"/>
</g>
<!-- arrivals_disk -->
<g id="node6" class="node">
<title>arrivals_disk</title>
<g id="a_node6"><a xlink:href="http://stats.ceda.ac.uk/ingest_state/stream.html?streamname=simple_checks" xlink:title="arrivals_disk">
<path fill="gray" stroke="black" d="M216,-689.73C216,-691.53 196.73,-693 173,-693 149.27,-693 130,-691.53 130,-689.73 130,-689.73 130,-660.27 130,-660.27 130,-658.47 149.27,-657 173,-657 196.73,-657 216,-658.47 216,-660.27 216,-660.27 216,-689.73 216,-689.73"/>
<path fill="none" stroke="black" d="M216,-689.73C216,-687.92 196.73,-686.45 173,-686.45 149.27,-686.45 130,-687.92 130,-689.73"/>
<text text-anchor="middle" x="173" y="-671.3" font-family="Times,serif" font-size="14.00">arrivals_disk</text>
</a>
</g>
</g>
<!-- arrivals&#45;&gt;arrivals_disk -->
<g id="edge1" class="edge">
<title>arrivals&#45;&gt;arrivals_disk</title>
<path fill="none" stroke="black" stroke-width="4" d="M98.49,-752.74C114.11,-736.66 133.96,-716.21 149.24,-700.47"/>
<polygon fill="black" stroke="black" stroke-width="4" points="151.89,-702.77 156.34,-693.16 146.87,-697.89 151.89,-702.77"/>
</g>
<!-- fileops -->
<g id="node5" class="node">
<title>fileops</title>
<ellipse fill="blue" stroke="black" cx="182" cy="-780" rx="34.39" ry="18"/>
<text text-anchor="middle" x="182" y="-776.3" font-family="Times,serif" font-size="14.00">fileops</text>
</g>
<!-- fileops&#45;&gt;arrivals_disk -->
<g id="edge2" class="edge">
<title>fileops&#45;&gt;arrivals_disk</title>
<path fill="none" stroke="black" d="M180.51,-761.99C179.11,-745.96 176.99,-721.69 175.36,-703.01"/>
<polygon fill="black" stroke="black" points="178.85,-702.69 174.49,-693.03 171.87,-703.3 178.85,-702.69"/>
</g>
<!-- arrivals_disk&#45;&gt;deposit -->
<g id="edge13" class="edge">
<title>arrivals_disk&#45;&gt;deposit</title>
<path fill="none" stroke="black" stroke-width="4" d="M182.25,-656.99C191.18,-640.57 204.82,-615.48 215.06,-596.64"/>
<polygon fill="black" stroke="black" stroke-width="4" points="218.22,-598.15 219.92,-587.69 212.07,-594.81 218.22,-598.15"/>
</g>
<!-- haystack -->
<g id="node7" class="node">
<title>haystack</title>
<ellipse fill="blue" stroke="black" cx="480" cy="-465" rx="41.69" ry="18"/>
<text text-anchor="middle" x="480" y="-461.3" font-family="Times,serif" font-size="14.00">haystack</text>
</g>
<!-- catalogue -->
<g id="node25" class="node">
<title>catalogue</title>
<g id="a_node25"><a xlink:href="https://catalogue.ceda.ac.uk" xlink:title="catalogue.ceda.ac.uk">
<polygon fill="white" stroke="black" points="451.5,-294 336.5,-294 336.5,-258 451.5,-258 451.5,-294"/>
<image xlink:href="images/cat_s.png" width="115px" height="36px" preserveAspectRatio="xMinYMin meet" x="336.5" y="-294"/>
<text text-anchor="middle" x="394" y="-272.9" font-family="Times,serif" font-size="12.00">catalogue.ceda.ac.uk</text>
</a>
</g>
</g>
<!-- haystack&#45;&gt;catalogue -->
<g id="edge23" class="edge">
<title>haystack&#45;&gt;catalogue</title>
<path fill="none" stroke="black" d="M481.39,-446.77C482.74,-420.12 482.1,-368.1 461,-331 454.11,-318.89 443.36,-308.44 432.46,-300.05"/>
<polygon fill="black" stroke="black" points="434.32,-297.07 424.16,-294.03 430.21,-302.74 434.32,-297.07"/>
</g>
<!-- fbi -->
<g id="node8" class="node">
<title>fbi</title>
<ellipse fill="blue" stroke="black" cx="567" cy="-465" rx="27" ry="18"/>
<text text-anchor="middle" x="567" y="-461.3" font-family="Times,serif" font-size="14.00">fbi</text>
</g>
<!-- data -->
<g id="node24" class="node">
<title>data</title>
<g id="a_node24"><a xlink:href="http://data.ceda.ac.uk" xlink:title="data.ceda.ac.uk">
<polygon fill="white" stroke="black" points="448.5,-221 341.5,-221 341.5,-163 448.5,-163 448.5,-221"/>
<image xlink:href="images/data_s.png" width="107px" height="58px" preserveAspectRatio="xMinYMin meet" x="341.5" y="-221"/>
<text text-anchor="middle" x="395" y="-188.9" font-family="Times,serif" font-size="12.00">data.ceda.ac.uk</text>
</a>
</g>
</g>
<!-- fbi&#45;&gt;data -->
<g id="edge24" class="edge">
<title>fbi&#45;&gt;data</title>
<path fill="none" stroke="black" d="M566.45,-446.76C564.8,-417.16 558.22,-355.64 532,-312 511.4,-277.71 477.54,-248.16 448.63,-227.09"/>
<polygon fill="black" stroke="black" points="450.41,-224.05 440.23,-221.1 446.34,-229.75 450.41,-224.05"/>
</g>
<!-- ingest_logs -->
<g id="node9" class="node">
<title>ingest_logs</title>
<ellipse fill="blue" stroke="black" cx="663" cy="-465" rx="50.89" ry="18"/>
<text text-anchor="middle" x="663" y="-461.3" font-family="Times,serif" font-size="14.00">ingest_logs</text>
</g>
<!-- ingest_mon -->
<g id="node11" class="node">
<title>ingest_mon</title>
<g id="a_node11"><a xlink:href="http://stats.ceda.ac.uk/ingest_state/index.html?reclen=30&amp;ingest1=on&amp;ingest2=on&amp;ingest3=on&amp;ingest4=on&amp;ingest5=on&amp;running=on&amp;warn=on&amp;fail=on&amp;killed=on&amp;died=on" xlink:title="ingest_mon">
<polygon fill="none" stroke="black" points="639.5,-809 568.5,-809 568.5,-751 639.5,-751 639.5,-809"/>
<image xlink:href="images/ingest_mon_s.png" width="71px" height="58px" preserveAspectRatio="xMinYMin meet" x="568.5" y="-809"/>
<text text-anchor="middle" x="604" y="-776.9" font-family="Times,serif" font-size="12.00">ingest_mon</text>
</a>
</g>
</g>
<!-- ingest_logs&#45;&gt;ingest_mon -->
<g id="edge4" class="edge">
<title>ingest_logs&#45;&gt;ingest_mon</title>
<path fill="none" stroke="black" d="M669.68,-483C685.98,-527.41 723.2,-649.28 677,-733 670.54,-744.71 659.71,-753.84 648.35,-760.77"/>
<polygon fill="black" stroke="black" points="646.64,-757.72 639.61,-765.65 650.05,-763.83 646.64,-757.72"/>
</g>
<!-- ingest_control&#45;&gt;fileops -->
<g id="edge5" class="edge">
<title>ingest_control&#45;&gt;fileops</title>
<path fill="none" stroke="black" d="M477.93,-797.83C464.58,-817.44 440.15,-847.84 410,-860.5 373.94,-875.64 268.35,-879.2 234,-860.5 213.44,-849.3 199.77,-826.1 191.63,-807.46"/>
<polygon fill="black" stroke="black" points="194.77,-805.9 187.77,-797.96 188.29,-808.54 194.77,-805.9"/>
</g>
<!-- ingest_control&#45;&gt;ingest_logs -->
<g id="edge3" class="edge">
<title>ingest_control&#45;&gt;ingest_logs</title>
<path fill="none" stroke="black" d="M515.26,-763.66C528.35,-756.55 544.64,-748.47 560,-743 597.28,-729.72 621.24,-754.04 647,-724 676.15,-690 669.57,-552.21 665.26,-493.12"/>
<polygon fill="black" stroke="black" points="668.74,-492.75 664.49,-483.04 661.76,-493.28 668.74,-492.75"/>
</g>
<!-- deposit_rpc -->
<g id="node14" class="node">
<title>deposit_rpc</title>
<polygon fill="red" stroke="black" stroke-width="0.5" points="385,-657 401,-657 401,-693 385,-693 385,-657"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="401,-657 417,-657 417,-693 401,-693 401,-657"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="417,-657 433,-657 433,-693 417,-693 417,-657"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="433,-657 449,-657 449,-693 433,-693 433,-657"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="449,-657 465,-657 465,-693 449,-693 449,-657"/>
<polygon fill="none" stroke="black" points="465,-693 385,-693 385,-657 465,-657 465,-693"/>
<text text-anchor="middle" x="425" y="-671.3" font-family="Times,serif" font-size="14.00">deposit_rpc</text>
</g>
<!-- ingest_control&#45;&gt;deposit_rpc -->
<g id="edge18" class="edge">
<title>ingest_control&#45;&gt;deposit_rpc</title>
<path fill="none" stroke="black" d="M478.43,-761.99C468.24,-745.59 452.68,-720.55 440.98,-701.72"/>
<polygon fill="black" stroke="black" points="443.83,-699.68 435.58,-693.03 437.89,-703.37 443.83,-699.68"/>
</g>
<!-- processing_disk&#45;&gt;deposit -->
<g id="edge11" class="edge">
<title>processing_disk&#45;&gt;deposit</title>
<path fill="none" stroke="black" stroke-width="4" d="M347.44,-761.98C324.74,-725.37 271.17,-639 244.56,-596.09"/>
<polygon fill="black" stroke="black" stroke-width="4" points="247.41,-594.04 239.16,-587.39 241.46,-597.73 247.41,-594.04"/>
</g>
<!-- rbq -->
<g id="node13" class="node">
<title>rbq</title>
<ellipse fill="blue" stroke="black" cx="608" cy="-675" rx="27" ry="18"/>
<text text-anchor="middle" x="608" y="-671.3" font-family="Times,serif" font-size="14.00">rbq</text>
</g>
<!-- deposit_rpc&#45;&gt;deposit -->
<g id="edge32" class="edge">
<title>deposit_rpc&#45;&gt;deposit</title>
<path fill="none" stroke="black" d="M384.78,-660.56C362.81,-653.43 335.04,-644.77 310,-638 294.6,-633.84 288.46,-638.57 275,-630 261.9,-621.67 251.01,-608.25 243.11,-596.32"/>
<polygon fill="black" stroke="black" points="245.93,-594.23 237.67,-587.59 239.99,-597.93 245.93,-594.23"/>
</g>
<!-- deposit_log -->
<g id="node15" class="node">
<title>deposit_log</title>
<polygon fill="red" stroke="black" stroke-width="0.5" points="483,-657 499,-657 499,-693 483,-693 483,-657"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="499,-657 515,-657 515,-693 499,-693 499,-657"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="515,-657 531,-657 531,-693 515,-693 515,-657"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="531,-657 547,-657 547,-693 531,-693 531,-657"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="547,-657 563,-657 563,-693 547,-693 547,-657"/>
<polygon fill="none" stroke="black" points="563,-693 483,-693 483,-657 563,-657 563,-693"/>
<text text-anchor="middle" x="523" y="-671.3" font-family="Times,serif" font-size="14.00">deposit_log</text>
</g>
<!-- fast_indexer_q -->
<g id="node16" class="node">
<title>fast_indexer_q</title>
<polygon fill="red" stroke="black" stroke-width="0.5" points="412.5,-552 431.9,-552 431.9,-588 412.5,-588 412.5,-552"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="431.9,-552 451.3,-552 451.3,-588 431.9,-588 431.9,-552"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="451.3,-552 470.7,-552 470.7,-588 451.3,-588 451.3,-552"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="470.7,-552 490.1,-552 490.1,-588 470.7,-588 470.7,-552"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="490.1,-552 509.5,-552 509.5,-588 490.1,-588 490.1,-552"/>
<polygon fill="none" stroke="black" points="509.5,-588 412.5,-588 412.5,-552 509.5,-552 509.5,-588"/>
<text text-anchor="middle" x="461" y="-566.3" font-family="Times,serif" font-size="14.00">fast_indexer_q</text>
</g>
<!-- deposit_log&#45;&gt;fast_indexer_q -->
<g id="edge9" class="edge">
<title>deposit_log&#45;&gt;fast_indexer_q</title>
<path fill="none" stroke="black" d="M512.76,-656.99C502.89,-640.59 487.82,-615.55 476.48,-596.72"/>
<polygon fill="black" stroke="black" points="479.41,-594.8 471.25,-588.03 473.41,-598.41 479.41,-594.8"/>
</g>
<!-- slow_indexer_q -->
<g id="node17" class="node">
<title>slow_indexer_q</title>
<polygon fill="red" stroke="black" stroke-width="0.5" points="527.5,-552 548.1,-552 548.1,-588 527.5,-588 527.5,-552"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="548.1,-552 568.7,-552 568.7,-588 548.1,-588 548.1,-552"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="568.7,-552 589.3,-552 589.3,-588 568.7,-588 568.7,-552"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="589.3,-552 609.9,-552 609.9,-588 589.3,-588 589.3,-552"/>
<polygon fill="red" stroke="black" stroke-width="0.5" points="609.9,-552 630.5,-552 630.5,-588 609.9,-588 609.9,-552"/>
<polygon fill="none" stroke="black" points="630.5,-588 527.5,-588 527.5,-552 630.5,-552 630.5,-588"/>
<text text-anchor="middle" x="579" y="-566.3" font-family="Times,serif" font-size="14.00">slow_indexer_q</text>
</g>
<!-- deposit_log&#45;&gt;slow_indexer_q -->
<g id="edge10" class="edge">
<title>deposit_log&#45;&gt;slow_indexer_q</title>
<path fill="none" stroke="black" d="M532.25,-656.99C541.12,-640.67 554.65,-615.78 564.88,-596.97"/>
<polygon fill="black" stroke="black" points="568.04,-598.49 569.74,-588.03 561.89,-595.15 568.04,-598.49"/>
</g>
<!-- deposit_web -->
<g id="node20" class="node">
<title>deposit_web</title>
<g id="a_node20"><a xlink:href="https://archdash1.ceda.ac.uk/current/a_sum" xlink:title="deposit_web">
<polygon fill="none" stroke="black" points="360.5,-599 283.5,-599 283.5,-541 360.5,-541 360.5,-599"/>
<image xlink:href="images/deposit_mon_s.png" width="71px" height="58px" preserveAspectRatio="xMinYMin meet" x="286.5" y="-599"/>
<text text-anchor="middle" x="322" y="-566.9" font-family="Times,serif" font-size="12.00">deposit_web</text>
</a>
</g>
</g>
<!-- deposit_log&#45;&gt;deposit_web -->
<g id="edge8" class="edge">
<title>deposit_log&#45;&gt;deposit_web</title>
<path fill="none" stroke="black" d="M492.41,-656.94C486.42,-654.02 480.1,-651.22 474,-649 453.43,-641.53 447.5,-642.08 426,-638 402.6,-633.56 393.86,-641.5 373,-630 362.73,-624.34 353.57,-615.75 345.95,-606.87"/>
<polygon fill="black" stroke="black" points="348.65,-604.65 339.65,-599.05 343.2,-609.04 348.65,-604.65"/>
</g>
<!-- fast_indexer_q&#45;&gt;fbi -->
<g id="edge6" class="edge">
<title>fast_indexer_q&#45;&gt;fbi</title>
<path fill="none" stroke="black" d="M485.96,-551.87C499.94,-541.68 517.28,-528.03 531,-514 538.06,-506.78 544.93,-498.15 550.75,-490.2"/>
<polygon fill="black" stroke="black" points="553.67,-492.14 556.61,-481.96 547.97,-488.08 553.67,-492.14"/>
</g>
<!-- slow_indexer_q&#45;&gt;fbi -->
<g id="edge7" class="edge">
<title>slow_indexer_q&#45;&gt;fbi</title>
<path fill="none" stroke="black" d="M577.02,-551.99C575.15,-535.96 572.32,-511.69 570.15,-493.01"/>
<polygon fill="black" stroke="black" points="573.62,-492.56 568.98,-483.03 566.67,-493.37 573.62,-492.56"/>
</g>
<!-- deposit&#45;&gt;deposit_log -->
<g id="edge31" class="edge">
<title>deposit&#45;&gt;deposit_log</title>
<path fill="none" stroke="black" d="M237.04,-587.6C244.72,-601.48 257.69,-620.5 275,-630 294.47,-640.69 452.67,-642.79 474,-649 477.56,-650.04 481.16,-651.33 484.71,-652.78"/>
<polygon fill="black" stroke="black" points="483.39,-656.03 493.94,-656.93 486.25,-649.64 483.39,-656.03"/>
</g>
<!-- archive -->
<g id="node19" class="node">
<title>archive</title>
<path fill="gray" stroke="black" d="M282,-479.73C282,-481.53 269.45,-483 254,-483 238.55,-483 226,-481.53 226,-479.73 226,-479.73 226,-450.27 226,-450.27 226,-448.47 238.55,-447 254,-447 269.45,-447 282,-448.47 282,-450.27 282,-450.27 282,-479.73 282,-479.73"/>
<path fill="none" stroke="black" d="M282,-479.73C282,-477.92 269.45,-476.45 254,-476.45 238.55,-476.45 226,-477.92 226,-479.73"/>
<text text-anchor="middle" x="254" y="-461.3" font-family="Times,serif" font-size="14.00">archive</text>
</g>
<!-- deposit&#45;&gt;archive -->
<g id="edge19" class="edge">
<title>deposit&#45;&gt;archive</title>
<path fill="none" stroke="black" stroke-width="4" d="M233.13,-551.99C237.02,-535.96 242.91,-511.69 247.44,-493.01"/>
<polygon fill="black" stroke="black" stroke-width="4" points="250.91,-493.58 249.87,-483.03 244.11,-491.93 250.91,-493.58"/>
</g>
<!-- jasmin -->
<g id="node21" class="node">
<title>jasmin</title>
<ellipse fill="blue" stroke="black" cx="296" cy="-360" rx="34.39" ry="18"/>
<text text-anchor="middle" x="296" y="-356.3" font-family="Times,serif" font-size="14.00">jasmin</text>
</g>
<!-- archive&#45;&gt;jasmin -->
<g id="edge25" class="edge">
<title>archive&#45;&gt;jasmin</title>
<path fill="none" stroke="black" stroke-width="4" d="M260.94,-446.99C267.57,-430.72 277.67,-405.94 285.33,-387.16"/>
<polygon fill="black" stroke="black" stroke-width="4" points="288.66,-388.27 289.19,-377.69 282.18,-385.63 288.66,-388.27"/>
</g>
<!-- ftp2 -->
<g id="node22" class="node">
<title>ftp2</title>
<ellipse fill="blue" stroke="black" cx="217" cy="-360" rx="27" ry="18"/>
<text text-anchor="middle" x="217" y="-356.3" font-family="Times,serif" font-size="14.00">ftp2</text>
</g>
<!-- archive&#45;&gt;ftp2 -->
<g id="edge26" class="edge">
<title>archive&#45;&gt;ftp2</title>
<path fill="none" stroke="black" stroke-width="4" d="M247.89,-446.99C242.04,-430.72 233.14,-405.94 226.4,-387.16"/>
<polygon fill="black" stroke="black" stroke-width="4" points="229.67,-385.92 223,-377.69 223.08,-388.29 229.67,-385.92"/>
</g>
<!-- dap -->
<g id="node23" class="node">
<title>dap</title>
<g id="a_node23"><a xlink:href="https://dap.ceda.ac.uk" xlink:title="dap.ceda.ac.uk">
<polygon fill="white" stroke="black" points="452,-126 338,-126 338,-73 452,-73 452,-126"/>
<image xlink:href="images/dap_s.png" width="114px" height="53px" preserveAspectRatio="xMinYMin meet" x="338" y="-126"/>
<text text-anchor="middle" x="395" y="-96.4" font-family="Times,serif" font-size="12.00">dap.ceda.ac.uk</text>
</a>
</g>
</g>
<!-- archive&#45;&gt;dap -->
<g id="edge27" class="edge">
<title>archive&#45;&gt;dap</title>
<path fill="none" stroke="black" stroke-width="4" d="M282.26,-463.16C323.88,-460.83 402.99,-452.14 461,-420 492.89,-402.33 518,-397.46 518,-361 518,-361 518,-361 518,-191 518,-158.94 490.56,-136.98 461.6,-122.73"/>
<polygon fill="black" stroke="black" stroke-width="4" points="462.72,-119.39 452.18,-118.37 459.78,-125.74 462.72,-119.39"/>
</g>
<!-- user -->
<g id="node27" class="node">
<title>user</title>
<polygon fill="yellow" stroke="black" points="298.68,-0.05 300.46,-0.15 302.22,-0.3 303.95,-0.49 305.65,-0.74 307.31,-1.03 308.92,-1.36 310.48,-1.75 311.99,-2.18 313.43,-2.65 314.8,-3.16 316.1,-3.71 317.32,-4.31 318.45,-4.94 319.51,-5.61 320.47,-6.31 321.35,-7.04 322.13,-7.8 322.81,-8.59 323.41,-9.41 323.91,-10.25 324.31,-11.11 324.62,-11.99 324.83,-12.89 324.96,-13.8 324.99,-14.72 324.93,-15.65 324.79,-16.59 324.57,-17.53 324.27,-18.47 323.89,-19.41 323.44,-20.35 322.92,-21.28 322.33,-22.2 321.69,-23.11 320.98,-24.01 320.22,-24.89 319.41,-25.75 318.56,-26.59 317.67,-27.41 316.73,-28.2 315.76,-28.96 314.76,-29.69 313.74,-30.39 312.68,-31.06 311.61,-31.69 310.52,-32.29 309.41,-32.84 308.28,-33.35 307.14,-33.82 305.99,-34.25 304.84,-34.64 303.67,-34.97 302.5,-35.26 301.33,-35.51 300.15,-35.7 298.96,-35.85 297.78,-35.95 296.59,-36 295.41,-36 294.22,-35.95 293.04,-35.85 291.85,-35.7 290.67,-35.51 289.5,-35.26 288.33,-34.97 287.16,-34.64 286.01,-34.25 284.86,-33.82 283.72,-33.35 282.59,-32.84 281.48,-32.29 280.39,-31.69 279.32,-31.06 278.26,-30.39 277.24,-29.69 276.24,-28.96 275.27,-28.2 274.33,-27.41 273.44,-26.59 272.59,-25.75 271.78,-24.89 271.02,-24.01 270.31,-23.11 269.67,-22.2 269.08,-21.28 268.56,-20.35 268.11,-19.41 267.73,-18.47 267.43,-17.53 267.21,-16.59 267.07,-15.65 267.01,-14.72 267.04,-13.8 267.17,-12.89 267.38,-11.99 267.69,-11.11 268.09,-10.25 268.59,-9.41 269.19,-8.59 269.87,-7.8 270.65,-7.04 271.53,-6.31 272.49,-5.61 273.55,-4.94 274.68,-4.31 275.9,-3.71 277.2,-3.16 278.57,-2.65 280.01,-2.18 281.52,-1.75 283.08,-1.36 284.69,-1.03 286.35,-0.74 288.05,-0.49 289.78,-0.3 291.54,-0.15 293.32,-0.05 295.1,0 296.9,0 298.68,-0.05"/>
<text text-anchor="middle" x="296" y="-14.3" font-family="Times,serif" font-size="14.00">user</text>
</g>
<!-- jasmin&#45;&gt;user -->
<g id="edge28" class="edge">
<title>jasmin&#45;&gt;user</title>
<path fill="none" stroke="black" stroke-width="4" d="M296,-341.72C296,-325.13 296,-299.35 296,-277 296,-277 296,-277 296,-98.5 296,-81.17 296,-61.72 296,-46.4"/>
<polygon fill="black" stroke="black" stroke-width="4" points="299.5,-46.06 296,-36.06 292.5,-46.06 299.5,-46.06"/>
</g>
<!-- ftp2&#45;&gt;user -->
<g id="edge29" class="edge">
<title>ftp2&#45;&gt;user</title>
<path fill="none" stroke="black" stroke-width="4" d="M223.88,-342.36C230,-326.01 238,-300.22 238,-277 238,-277 238,-277 238,-98.5 238,-74.27 255.79,-52.5 271.67,-37.88"/>
<polygon fill="black" stroke="black" stroke-width="4" points="273.98,-40.51 279.22,-31.31 269.38,-35.24 273.98,-40.51"/>
</g>
<!-- dap&#45;&gt;user -->
<g id="edge30" class="edge">
<title>dap&#45;&gt;user</title>
<path fill="none" stroke="black" stroke-width="4" d="M363.13,-72.91C349.03,-61.59 332.74,-48.51 319.74,-38.07"/>
<polygon fill="black" stroke="black" stroke-width="4" points="321.72,-35.16 311.73,-31.63 317.33,-40.62 321.72,-35.16"/>
</g>
<!-- data&#45;&gt;dap -->
<g id="edge22" class="edge">
<title>data&#45;&gt;dap</title>
<path fill="none" stroke="black" d="M395,-162.86C395,-154.43 395,-145.08 395,-136.23"/>
<polygon fill="black" stroke="black" points="398.5,-136.16 395,-126.16 391.5,-136.16 398.5,-136.16"/>
</g>
<!-- catalogue&#45;&gt;data -->
<g id="edge21" class="edge">
<title>catalogue&#45;&gt;data</title>
<path fill="none" stroke="black" d="M394.21,-257.61C394.31,-249.89 394.42,-240.48 394.53,-231.25"/>
<polygon fill="black" stroke="black" points="398.04,-231.05 394.66,-221.01 391.04,-230.97 398.04,-231.05"/>
</g>
<!-- archive_site -->
<g id="node26" class="node">
<title>archive_site</title>
<g id="a_node26"><a xlink:href="https://archive.ceda.ac.uk" xlink:title="archive.ceda.ac.uk">
<polygon fill="white" stroke="black" points="452,-389 348,-389 348,-331 452,-331 452,-389"/>
<image xlink:href="images/archive_s.png" width="104px" height="58px" preserveAspectRatio="xMinYMin meet" x="348" y="-389"/>
<text text-anchor="middle" x="400" y="-356.9" font-family="Times,serif" font-size="12.00">archive.ceda.ac.uk</text>
</a>
</g>
</g>
<!-- archive_site&#45;&gt;catalogue -->
<g id="edge20" class="edge">
<title>archive_site&#45;&gt;catalogue</title>
<path fill="none" stroke="black" d="M397.94,-330.78C397.31,-322.18 396.62,-312.75 395.99,-304.22"/>
<polygon fill="black" stroke="black" points="399.47,-303.74 395.25,-294.02 392.48,-304.25 399.47,-303.74"/>
</g>
</g>
</svg>



<script>

function update_node_text(title_text, text) {
    var node = get_node(title_text);
    var t = node.getElementsByTagName("text")[0];
    t.textContent = text;
}

function append_node_text(title_text, text) {
    var node = get_node(title_text);
    var t = node.getElementsByTagName("text")[0];
    t.textContent = node.title + text;
}



function node_shapes(node) {
    // file the main shape object for a node
    var shapes = [];
    for (var i of ["polygon", "rectangle", "path", "ellipse"]) {
        for (j of node.getElementsByTagName(i)) {
            shapes.push(j);
        }
    }
    return shapes
}

function store_base() {
    var svg = document.getElementById("graph0");
    var titleTags = svg.getElementsByTagName("title");
    for (var i = 0; i < titleTags.length; i++) {
        var p = titleTags[i].parentElement;
        var s = node_shapes(p)[0];
        p.fill = s.getAttribute("fill");
        p.stroke = s.getAttribute("stroke");
        p.title = titleTags[i].textContent;
    }
}

function update_node_colour(title_text, fill, stroke) {
    var node = get_node(title_text);
    for (var s of node_shapes(node)) {
        s.setAttribute("fill", fill);
        s.setAttribute("stroke", stroke);
    }
}

function flag_error(title_text) {update_node_colour(title_text, "#ff9999", "#ff0000")}
function flag_warning(title_text) {update_node_colour(title_text, "#ffcc55", "#ccaa00")}
function flag_ok(title_text) {update_node_colour(title_text, "#77cc77", "#00ff00")}

function flag_clear(title_text) {
    var node = get_node(title_text);
    for (var s of node_shapes(node)) {
        s.setAttribute("fill", node.fill);
        s.setAttribute("stroke", node.stroke);
    }
}

function tooltip(title_text, text) {
    var node = get_node(title_text);
    var a = node.getElementsByTagName("a")[0];
    a.setAttribute("xlink:title", text);
}

function get_node(title_text) {
    var svg = document.getElementById("graph0");
    var titleTags = svg.getElementsByTagName("title");
    var found;
    for (var i = 0; i < titleTags.length; i++) {
        if (titleTags[i].textContent == title_text) {
            found = titleTags[i];
            break;
        }
    }
    return found.parentElement;
}


function up(title_text, test_name) {
    var value = '-';
    if (grabstore["uptimerobot"] != undefined) {
        value = grabstore["uptimerobot"][test_name]
    }
    if (value == "-") {flag_clear(title_text)}
    else if (value == 2) {flag_ok(title_text)}
    else {flag_error(title_text)}
    setTimeout(function () {up(title_text, test_name)}, 1000);
}

function disk_full(title_text, test_name, warn_level, error_level) {
    var value = '-';
    if (grabstore["checks"] != undefined) {
        value = grabstore["checks"][test_name]
    }
    if (value == "-") {flag_clear(title_text)}
    else if (value > error_level) {flag_error(title_text)}
    else if (value > warn_level) {flag_warning(title_text)}
    else {flag_ok(title_text)}
    tooltip(title_text, " [" + value +"%]")
    setTimeout(function () {disk_full(title_text, test_name, warn_level, error_level)}, 2400);
}

function ingest_mon_update() {
    title_text = "ingest_mon";
    var error = false;
    var warn = false;
    var ok = false;
    var text = '';
    if (grabstore["ingest"] != undefined) {
        var s = grabstore["ingest"];
        error = s["running"] > 30 || s["warn"] > 30 || s["fail"] > 10 || s["died"] > 10 || s["killed"] > 10;
        warn = s["running"] > 25 || s["warn"] > 10 || s["fail"] > 5 || s["died"] > 5 || s["killed"] > 5;
        ok = true;
        for (var k in s) { text += k + ": " + s[k] + "\n"}
    }

    if (error) {flag_error(title_text)}
    else if (warn) {flag_warning(title_text)}
    else if (ok) {flag_ok(title_text)}
    else {flag_clear(title_text)}
    tooltip(title_text, text);
    console.log(error, warn, text);
    setTimeout(function () {ingest_mon_update()}, 2400);
}

function currrent_deposits_update() {
    title_text = "deposit_web";
    var error = false;
    var warn = false;
    var ok = false;
    var text = '';
    if (grabstore["current_deposits"] != undefined) {
        var s = grabstore["current_deposits"];
        error = s["filerate_2min"] < 0.01;
        warn = s["filerate_2min"] < 0.1;
        ok = true;
        for (var k in s) { text += k + ": " + s[k] + "\n"}
    }

    if (error) {flag_error(title_text)}
    else if (warn) {flag_warning(title_text)}
    else if (ok) {flag_ok(title_text)}
    else {flag_clear(title_text)}
    tooltip(title_text, text);
    setTimeout(function () {currrent_deposits_update()}, 2100);
}


function queue_update(title_text, key, warn_limit, error_limit) {
    var error = false;
    var warn = false;
    var ok = false;
    if (grabstore["current_deposits"] != undefined) {
        var s = grabstore["current_deposits"];
        error = s["key"] < error_limit;
        warn = s["key"] < warn_limit;
        ok = true;
    }

    if (error) {flag_error(title_text)}
    else if (warn) {flag_warning(title_text)}
    else if (ok) {flag_ok(title_text)}
    else {flag_clear(title_text)}
    setTimeout(function () {queue_update(title_text, key, warn_limit, error_limit)}, 2300);
}



store_base();
    uptimerobot(60000);
    grab("https://archdash.ceda.ac.uk/current/api", "current_deposits", 5000);
    ingest_sum(30000);
    simple_check_output(30000);
    up("arrivals", "arrivals");
    up("dap", "http://dap.ceda.ac.uk");
    up("archive_site", "archive.ceda.ac.uk");
    up("ftp2", "ftp.ceda.ac.uk");
    up("catalogue", "catalogue.ceda.ac.uk");
    up("data", "data.ceda.ac.uk");
    up("fbi", "FBI");
    up("haystack", "Haystack");
    disk_full("processing_disk", "/datacentre/processing3", 80, 95);
    disk_full("arrivals_disk", "/datacentre/arrivals", 70, 95);
    ingest_mon_update();
    currrent_deposits_update();
    queue_update("fast_indexer_q", "fastq_len", 0, 1000);
    queue_update("slow_indexer_q", "slowq_len", 0, 1000);

</script>

</body>
</html>